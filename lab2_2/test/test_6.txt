Q Q1 Q3 QQ QQ1
Q a(a*b+ba)* -> QQ
QQ a -> Q1
QQ a*b+ba -> QQ
Q1 a -> QQ
QQ b/a -> QQ1
QQ a -> Q